<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Surgeon's Dilemma: Why LLMs Can't Do Simple Math</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .hero {
            text-align: center;
            padding: 60px 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }

        .hero h1 {
            font-size: 3em;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.3em;
            color: #7f8c8d;
            margin-bottom: 30px;
        }

        .bug-demo {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            border: 2px solid #e0e0e0;
        }

        .prompt-box {
            background: #2c3e50;
            color: #fff;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            position: relative;
            overflow: hidden;
        }

        .prompt-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .response {
            margin-top: 10px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 500;
        }

        .correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .wrong {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .section {
            background: white;
            padding: 40px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 2em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .circuit-diagram {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .layer-box {
            display: inline-block;
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 15px 25px;
            margin: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .layer-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .layer-box.hijacker {
            border-color: #e74c3c;
            background: #ffe5e5;
        }

        .layer-box.reasoning {
            border-color: #27ae60;
            background: #e5ffe5;
        }

        .layer-box.entangled {
            border-color: #f39c12;
            background: #fff5e5;
        }

        .neuron-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .neuron-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .neuron-card:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .neuron-id {
            font-weight: bold;
            color: #667eea;
            font-size: 0.9em;
        }

        .activation-bar {
            height: 8px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }

        .activation-fill {
            height: 100%;
            background: #27ae60;
            transition: width 0.5s ease;
        }

        .intervention-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .result-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .result-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .badge-success {
            background: #d4edda;
            color: #155724;
        }

        .badge-partial {
            background: #fff3cd;
            color: #856404;
        }

        .badge-failure {
            background: #f8d7da;
            color: #721c24;
        }

        .graph-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .axis-label {
            font-size: 0.9em;
            color: #7f8c8d;
            margin: 10px 0;
        }

        .insight-box {
            background: linear-gradient(135deg, #f6f8fb, #e9ecef);
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .insight-box h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .key-finding {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .key-finding::before {
            content: "üí° ";
            font-size: 1.5em;
        }

        .interactive-demo {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider {
            width: 100%;
            height: 40px;
            -webkit-appearance: none;
            appearance: none;
            background: #ddd;
            outline: none;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            background: #667eea;
            cursor: pointer;
            border-radius: 50%;
        }

        .slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            background: #667eea;
            cursor: pointer;
            border-radius: 50%;
        }

        .value-display {
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }

        .transition-zone {
            background: repeating-linear-gradient(
                45deg,
                #f8d7da,
                #f8d7da 10px,
                #fff3cd 10px,
                #fff3cd 20px
            );
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .footer {
            text-align: center;
            padding: 40px 20px;
            color: white;
            margin-top: 50px;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2em;
            }
            
            .section {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1>The Surgeon's Dilemma</h1>
            <p class="subtitle">Why Llama Can't Tell if 9.8 or 9.11 is Bigger</p>
            <p style="color: #7f8c8d; margin-top: 20px;">
                A mechanistic exploration of an entangled bug that resists all attempts at surgical removal
            </p>
        </div>

        <!-- The Bug in Action -->
        <div class="section">
            <h2>üêõ The Bug in Action</h2>
            <p>Here's a simple question that breaks Llama-3.1-8B-Instruct:</p>
            
            <div class="bug-demo">
                <h3>Chat Template Format (Triggers Bug)</h3>
                <div class="prompt-box">
                    &lt;|start_header_id|&gt;user&lt;|end_header_id|&gt;<br>
                    Which is bigger: 9.8 or 9.11?<br>
                    &lt;|start_header_id|&gt;assistant&lt;|end_header_id|&gt;
                </div>
                <div class="response wrong">
                    ‚ùå "9.11 is bigger than 9.8"
                </div>
                
                <h3 style="margin-top: 30px;">Simple Format (Works Correctly)</h3>
                <div class="prompt-box">
                    Which is bigger: 9.8 or 9.11?<br>
                    Answer:
                </div>
                <div class="response correct">
                    ‚úÖ "9.8 is bigger than 9.11"
                </div>
            </div>
            
            <div class="key-finding">
                <strong>The same model, the same question, but different formats produce opposite answers!</strong>
                This isn't just a random error - it's a systematic failure that happens 100% of the time with the chat template.
            </div>
        </div>


        <!-- The Entangled Circuits -->
        <div class="section">
            <h2>üß† Two Entangled Circuits</h2>
            <p>We identified two overlapping neural circuits responsible for this behavior:</p>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
                <div>
                    <h3 style="color: #e74c3c;">üî¥ Hijacker Circuit (Layers 7-15)</h3>
                    <p>Activates strongly with chat template, associates "9.11" with dates/events</p>
                    <div class="neuron-grid">
                        <div class="neuron-card" style="border-color: #e74c3c;">
                            <div class="neuron-id">L7/N1978</div>
                            <div class="activation-bar"><div class="activation-fill" style="width: 80%; background: #e74c3c;"></div></div>
                            <small>Unique to buggy</small>
                        </div>
                        <div class="neuron-card" style="border-color: #f39c12;">
                            <div class="neuron-id">L14/N12639</div>
                            <div class="activation-bar"><div class="activation-fill" style="width: 90%; background: #f39c12;"></div></div>
                            <small>‚ö†Ô∏è Entangled!</small>
                        </div>
                        <div class="neuron-card" style="border-color: #e74c3c;">
                            <div class="neuron-id">L15/N3136</div>
                            <div class="activation-bar"><div class="activation-fill" style="width: 75%; background: #e74c3c;"></div></div>
                            <small>2x activation</small>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 style="color: #27ae60;">üü¢ Reasoning Circuit (Layers 28-31)</h3>
                    <p>Handles decimal comparisons, fires stronger during correct reasoning</p>
                    <div class="neuron-grid">
                        <div class="neuron-card" style="border-color: #27ae60;">
                            <div class="neuron-id">L31/N13336</div>
                            <div class="activation-bar"><div class="activation-fill" style="width: 95%; background: #27ae60;"></div></div>
                            <small>23% stronger when correct</small>
                        </div>
                        <div class="neuron-card" style="border-color: #27ae60;">
                            <div class="neuron-id">L31/N12004</div>
                            <div class="activation-bar"><div class="activation-fill" style="width: 92%; background: #27ae60;"></div></div>
                            <small>25% stronger when correct</small>
                        </div>
                        <div class="neuron-card" style="border-color: #27ae60;">
                            <div class="neuron-id">L30/N840</div>
                            <div class="activation-bar"><div class="activation-fill" style="width: 70%; background: #27ae60;"></div></div>
                            <small>Shared activation</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="key-finding">
                <strong>The Entanglement Problem:</strong> Neuron L14/N12639 is active in BOTH correct and incorrect responses! 
                It's essential for decimal processing but also triggers the bug. You can't remove it without breaking the model.
            </div>
        </div>

        <!-- Intervention Attempts -->
        <div class="section">
            <h2>‚ö° The Intervention Experiments</h2>
            <p>We tried various surgical interventions to fix the bug:</p>
            
            <div class="interactive-demo">
                <h3>Ablation Strength Simulator</h3>
                <p>See what happens when we suppress the hijacker circuit neurons:</p>
                
                <div class="slider-container">
                    <input type="range" class="slider" id="ablationSlider" min="0" max="5" step="0.5" value="0">
                    <div class="value-display">Ablation Strength: -<span id="ablationValue">0</span></div>
                </div>
                
                <div id="ablationResult" style="margin-top: 20px; padding: 20px; border-radius: 10px; transition: all 0.3s ease;">
                    <div style="font-size: 1.2em; font-weight: bold; margin-bottom: 10px;">Result:</div>
                    <div id="resultText">No intervention - Bug present (100% error rate)</div>
                </div>
            </div>
            
            <div class="transition-zone">
                <h3>üö® The Critical Transition Zone (Ablation -4.0 to -4.5)</h3>
                <p><strong>No "Sweet Spot" Exists!</strong></p>
                <p>The model jumps directly from "confidently wrong" to "completely incoherent"</p>
            </div>
            
            <div class="intervention-results">
                <div class="result-card">
                    <div class="result-header">
                        <h4>Suppress "Both" Tokens</h4>
                        <span class="result-badge badge-failure">Failed</span>
                    </div>
                    <p>Tried to prevent hedging behavior at layers 22-25</p>
                    <p><strong>Result:</strong> Still produces wrong answer</p>
                </div>
                
                <div class="result-card">
                    <div class="result-header">
                        <h4>Boost "9" Token</h4>
                        <span class="result-badge badge-failure">Failed</span>
                    </div>
                    <p>Amplified commitment to correct answer at Layer 25</p>
                    <p><strong>Result:</strong> No improvement</p>
                </div>
                
                <div class="result-card">
                    <div class="result-header">
                        <h4>Redirect Both ‚Üí 9</h4>
                        <span class="result-badge badge-failure">Failed</span>
                    </div>
                    <p>Dynamic redirection at layers 23-25</p>
                    <p><strong>Result:</strong> Triggered but ineffective</p>
                </div>
                
                <div class="result-card">
                    <div class="result-header">
                        <h4>Pattern Transplant</h4>
                        <span class="result-badge badge-failure">Broke Model</span>
                    </div>
                    <p>Copied activation patterns from correct format</p>
                    <p><strong>Result:</strong> Produced only whitespace</p>
                </div>
            </div>
        </div>

        <!-- Layer 25: The Critical Divergence -->
        <div class="section">
            <h2>üî¨ Layer 25: Where Paths Diverge</h2>
            <p>Using logit lens analysis, we discovered the exact moment where the model's processing diverges:</p>
            
            <div class="circuit-diagram">
                <div style="display: flex; justify-content: center; align-items: center; flex-wrap: wrap;">
                    <div class="layer-box">Layer 0-24<br><small>Similar processing</small></div>
                    <span style="font-size: 2em; margin: 0 20px;">‚Üí</span>
                    <div class="layer-box entangled pulse">Layer 25<br><small>Critical divergence!</small></div>
                    <span style="font-size: 2em; margin: 0 20px;">‚Üí</span>
                    <div class="layer-box">Layer 26-32<br><small>Different outputs</small></div>
                </div>
            </div>
            
            <div class="insight-box">
                <h3>What Happens at Layer 25?</h3>
                <p><strong>Correct Format:</strong> Commits to token "9" with 22.2% probability - starting the correct answer "9.8"</p>
                <p><strong>Wrong Format:</strong> Hedges with token "Both" at 36.5% probability - never commits to the right answer</p>
                <p style="margin-top: 15px;">This is the exact moment where the model "decides" whether to give the right or wrong answer!</p>
            </div>
        </div>
        
        <!-- Validation with Other Bugs -->
        <div class="section">
            <h2>‚úÖ A Tale of Two Bugs: Strawberry Success vs Decimal Failure</h2>
            <p>To validate our methods, we tested them on other bugs. The contrast is revealing:</p>
            
            <!-- Strawberry Success Story -->
            <div style="background: #d4edda; border: 2px solid #27ae60; border-radius: 15px; padding: 30px; margin: 30px 0;">
                <h3 style="color: #155724; margin-bottom: 20px;">üçì SUCCESS: The Strawberry Bug Fix</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <h4>The Problem</h4>
                        <div class="prompt-box" style="background: #2c3e50;">
                            Prompt: "How many times does the letter 'r' appear in 'strawberry'?"
                        </div>
                        <div class="response wrong">
                            ‚ùå Model says: "2" (Wrong - there are 3 r's)
                        </div>
                    </div>
                    
                    <div>
                        <h4>The Fix That Worked!</h4>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <p><strong>Intervention:</strong> MLP amplification (2x boost) at layers 5, 6, 7</p>
                            <p><strong>Target:</strong> Early letter recognition circuits</p>
                        </div>
                        <div class="response correct">
                            ‚úÖ Model says: "3" (Correct!)
                        </div>
                    </div>
                </div>
                
                <div class="key-finding" style="background: white; border-color: #27ae60; margin-top: 20px;">
                    <strong>Why It Worked:</strong> The strawberry bug is a <em>separable</em> error. The letter-counting circuit 
                    is distinct from other language capabilities. We can boost it without breaking anything else.
                </div>
            </div>
            
            <!-- Decimal Failure Story -->
            <div style="background: #f8d7da; border: 2px solid #e74c3c; border-radius: 15px; padding: 30px; margin: 30px 0;">
                <h3 style="color: #721c24; margin-bottom: 20px;">‚ùå FAILURE: The Decimal Bug Resistance</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <h4>The Problem</h4>
                        <div class="prompt-box" style="background: #2c3e50;">
                            Chat Template: "Which is bigger: 9.8 or 9.11?"
                        </div>
                        <div class="response wrong">
                            ‚ùå Model says: "9.11 is bigger" (Wrong)
                        </div>
                    </div>
                    
                    <div>
                        <h4>Every Fix Failed</h4>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <p>‚ùå Layer 25 activation patching ‚Üí Gibberish</p>
                            <p>‚ùå Suppress hijacker neurons ‚Üí Still wrong</p>
                            <p>‚ùå Boost correct path ‚Üí No effect</p>
                            <p>‚ùå Steering vectors ‚Üí Breaks model</p>
                        </div>
                        <div class="response wrong">
                            üí• Result: Wrong answer OR total incoherence
                        </div>
                    </div>
                </div>
                
                <div class="key-finding" style="background: white; border-color: #e74c3c; margin-top: 20px;">
                    <strong>Why It Failed:</strong> The decimal bug is <em>entangled</em>. The same neurons that cause the error 
                    are essential for understanding numbers at all. Touch them, and everything breaks.
                </div>
            </div>
            
            <!-- Side-by-side comparison -->
            <div style="margin: 40px 0;">
                <h3 style="text-align: center; margin-bottom: 30px;">The Critical Difference</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div class="circuit-diagram" style="background: #e8f5e9;">
                        <h4 style="color: #27ae60;">Strawberry: Separable Circuit</h4>
                        <div style="margin: 20px 0;">
                            <div class="layer-box" style="background: #c8e6c9;">
                                Letter Recognition
                                <br><small>Layers 5-7</small>
                            </div>
                            <p style="margin: 15px 0;">‚ÜïÔ∏è Independent</p>
                            <div class="layer-box">
                                Other Capabilities
                                <br><small>Unaffected</small>
                            </div>
                        </div>
                        <p><strong>Can boost letter counting without breaking other functions</strong></p>
                    </div>
                    
                    <div class="circuit-diagram" style="background: #ffebee;">
                        <h4 style="color: #e74c3c;">Decimal: Entangled Circuit</h4>
                        <div style="margin: 20px 0;">
                            <div class="layer-box entangled" style="background: #ffcdd2;">
                                Decimal Processing + Bug
                                <br><small>Layers 7-15, 25, 28-31</small>
                            </div>
                            <p style="margin: 15px 0;">üîó Inseparable</p>
                            <div class="layer-box entangled" style="background: #ffcdd2;">
                                Same neurons!
                                <br><small>L14/N12639</small>
                            </div>
                        </div>
                        <p><strong>Can't suppress bug without destroying number understanding</strong></p>
                    </div>
                </div>
            </div>
            
            <!-- Intervention spectrum -->
            <div class="insight-box" style="background: linear-gradient(90deg, #d4edda, #fff3cd, #f8d7da);">
                <h3>The Intervention Spectrum</h3>
                <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <div style="text-align: center;">
                        <strong style="color: #155724;">‚úÖ Fully Fixable</strong>
                        <p>Strawberry (100% fixed)</p>
                        <p><small>Separable circuits</small></p>
                    </div>
                    <div style="text-align: center;">
                        <strong style="color: #856404;">‚ö†Ô∏è Partially Fixable</strong>
                        <p>Occurrence (50% improved)</p>
                        <p><small>Some entanglement</small></p>
                    </div>
                    <div style="text-align: center;">
                        <strong style="color: #721c24;">‚ùå Unfixable</strong>
                        <p>Decimal, Momentum (0% success)</p>
                        <p><small>Fully entangled</small></p>
                    </div>
                </div>
            </div>
            
            <div class="key-finding">
                <strong>The Lesson:</strong> Not all bugs are created equal. Simple, localized errors like strawberry can be surgically fixed. 
                But when the bug is woven into the model's fundamental representations‚Äîlike with decimal comparisons‚Äîintervention becomes impossible. 
                The bug and the capability are one and the same.
            </div>
        </div>

        <!-- The Surgeon's Dilemma -->
        <div class="section">
            <h2>üî™ The Surgeon's Dilemma Explained</h2>
            
            <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 30px; border-radius: 15px; margin: 30px 0;">
                <h3 style="color: white; margin-bottom: 20px;">Why Can't We Fix This Bug?</h3>
                <p style="font-size: 1.1em; line-height: 1.8;">
                    Imagine a surgeon trying to remove a tumor that has grown intertwined with vital organs. 
                    Cut too little, and the tumor remains. Cut too much, and the patient dies. 
                    <strong>There's no safe middle ground.</strong>
                </p>
                <p style="font-size: 1.1em; line-height: 1.8; margin-top: 20px;">
                    That's exactly what we face with this bug. The same neurons that produce wrong answers 
                    are essential for correct decimal processing. It's not a separate "bug module" - it's a 
                    parasitic process woven into the model's core capabilities.
                </p>
            </div>
            
            <div class="key-finding">
                <strong>The Irremediable Entanglement:</strong> This isn't a bug you can patch. 
                It's a fundamental consequence of how the model learned to process different prompt formats. 
                The bug and the capability are the same circuit, activated differently.
            </div>
        </div>

        <!-- Implications -->
        <div class="section">
            <h2>üéØ What This Means for AI Safety</h2>
            
            <div class="insight-box">
                <h3>1. Not All Bugs Are Fixable</h3>
                <p>Some model behaviors are so deeply entangled with core capabilities that removing them would break the model entirely.</p>
            </div>
            
            <div class="insight-box">
                <h3>2. Format Matters More Than We Think</h3>
                <p>Subtle prompt variations can activate completely different neural pathways, leading to opposite behaviors.</p>
            </div>
            
            <div class="insight-box">
                <h3>3. The Limits of Surgical Intervention</h3>
                <p>The dream of "just removing the bad neurons" doesn't work when those neurons are also doing essential work.</p>
            </div>
            
            <div class="insight-box">
                <h3>4. Prevention Over Cure</h3>
                <p>If bugs like this can't be fixed post-training, we need to prevent them during training through better data curation and architectures.</p>
            </div>
        </div>

        <!-- Conclusion -->
        <div class="section" style="background: linear-gradient(135deg, #f6f8fb, #e9ecef);">
            <h2>üìù Conclusions</h2>
            
            <p style="font-size: 1.1em; line-height: 1.8;">
                Our investigation reveals a sobering truth: <strong>not all AI bugs are fixable bugs.</strong> 
                The decimal comparison error in Llama-3.1-8B-Instruct isn't a simple mistake we can patch - 
                it's a fundamental entanglement between the model's bug and its capability.
            </p>
            
            <p style="font-size: 1.1em; line-height: 1.8; margin-top: 20px;">
                Layer 25 shows us exactly where the paths diverge, but intervening there - or anywhere else - 
                only demonstrates that the bug and the feature are inseparable. The neurons firing incorrectly 
                for "9.11 > 9.8" are the same ones needed for the model to understand decimals at all.
            </p>
            
            <p style="font-size: 1.1em; line-height: 1.8; margin-top: 20px;">
                This case study provides concrete evidence that some undesirable behaviors in AI systems may be 
                irremediable - woven so deeply into the fabric of the model that they cannot be removed without 
                destroying core functionality. It's a reminder that as we build more powerful AI systems, 
                we need to be extremely careful about what we teach them, because some lessons can't be unlearned.
            </p>
        </div>

        <div class="footer">
            <p>Based on "The Surgeon's Dilemma: A Mechanistic Case Study of an Entangled Circuit that Resists Intervention"</p>
            <p style="margin-top: 10px; opacity: 0.8;">Interactive visualization of mechanistic interpretability research</p>
        </div>
    </div>

    <script>
        // Interactive ablation slider
        const slider = document.getElementById('ablationSlider');
        const valueDisplay = document.getElementById('ablationValue');
        const resultDiv = document.getElementById('ablationResult');
        const resultText = document.getElementById('resultText');

        slider.addEventListener('input', function() {
            const value = parseFloat(this.value);
            valueDisplay.textContent = value.toFixed(1);
            
            if (value === 0) {
                resultDiv.style.background = '#f8d7da';
                resultDiv.style.border = '2px solid #f5c6cb';
                resultText.innerHTML = '<span style="color: #721c24;">No intervention - Bug present (100% error rate)</span><br>Model says: "9.11 is bigger than 9.8"';
            } else if (value < 4) {
                resultDiv.style.background = '#f8d7da';
                resultDiv.style.border = '2px solid #f5c6cb';
                resultText.innerHTML = '<span style="color: #721c24;">Weak suppression - Bug still present (~90% error rate)</span><br>Model says: "9.11 is bigger than 9.8"';
            } else if (value >= 4 && value < 4.5) {
                resultDiv.style.background = '#fff3cd';
                resultDiv.style.border = '2px solid #ffc107';
                resultText.innerHTML = '<span style="color: #856404;">‚ö†Ô∏è CRITICAL TRANSITION ZONE</span><br>Rapid shift from wrong to incoherent!';
            } else {
                resultDiv.style.background = '#e0e0e0';
                resultDiv.style.border = '2px solid #999';
                resultText.innerHTML = '<span style="color: #555;">Complete incoherence (100% gibberish)</span><br>Model outputs: "The number 100 is not mentioned..." or "://:///phpphp"';
            }
        });

        // Add hover effects to layer boxes
        document.querySelectorAll('.layer-box').forEach(box => {
            box.addEventListener('mouseenter', function() {
                if (this.classList.contains('entangled')) {
                    this.style.transform = 'scale(1.1)';
                    this.style.boxShadow = '0 15px 30px rgba(243, 156, 18, 0.4)';
                }
            });
            
            box.addEventListener('mouseleave', function() {
                this.style.transform = '';
                this.style.boxShadow = '';
            });
        });

        // Add click interaction to neuron cards
        document.querySelectorAll('.neuron-card').forEach(card => {
            card.addEventListener('click', function() {
                const fill = this.querySelector('.activation-fill');
                fill.style.transition = 'width 1s ease';
                fill.style.width = '100%';
                setTimeout(() => {
                    fill.style.width = fill.getAttribute('data-original-width') || '70%';
                }, 1000);
            });
        });

        // Store original widths
        document.querySelectorAll('.activation-fill').forEach(fill => {
            fill.setAttribute('data-original-width', fill.style.width);
        });
    </script>
</body>
</html>